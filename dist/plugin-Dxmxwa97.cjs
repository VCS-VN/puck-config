"use strict";(function(){var k=tinymce.util.Tools.resolve("tinymce.PluginManager");const E=(t,e,n)=>{var o;return n(t,e.prototype)?!0:((o=t.constructor)===null||o===void 0?void 0:o.name)===e.name},w=t=>{const e=typeof t;return t===null?"null":e==="object"&&Array.isArray(t)?"array":e==="object"&&E(t,String,(n,o)=>o.isPrototypeOf(n))?"string":e},I=t=>e=>w(e)===t,g=t=>e=>typeof e===t,N=I("string"),h=g("boolean"),M=t=>t==null,S=t=>!M(t),f=g("function"),m=t=>e=>e.options.get(t),q=t=>{const e=t.options.register,n=r=>l=>{const c=h(l)||N(l);return c?h(l)?{value:l?r:"",valid:c}:{value:l.trim(),valid:c}:{valid:!1,message:"Must be a boolean or string."}},o="bold italic | quicklink h2 h3 blockquote";e("quickbars_selection_toolbar",{processor:n(o),default:o});const s="quickimage quicktable";e("quickbars_insert_toolbar",{processor:n(s),default:s});const i="alignleft aligncenter alignright";e("quickbars_image_toolbar",{processor:n(i),default:i})},C=m("quickbars_selection_toolbar"),x=m("quickbars_insert_toolbar"),P=m("quickbars_image_toolbar");let b=0;const A=t=>{const n=new Date().getTime(),o=Math.floor(Math.random()*1e9);return b++,t+"_"+o+b+String(n)},B=(t,e,n)=>{t.execCommand("mceInsertTable",!1,{rows:n,columns:e})},L=(t,e,n)=>{const o=t.editorUpload.blobCache,s=o.create(A("mceu"),n,e);o.add(s),t.insertContent(t.dom.createHTML("img",{src:s.blobUri()}))},D=t=>new Promise(e=>{const n=new FileReader;n.onloadend=()=>{e(n.result.split(",")[1])},n.readAsDataURL(t)});var $=tinymce.util.Tools.resolve("tinymce.util.Delay");const F=t=>new Promise(e=>{let n=!1;const o=document.createElement("input");o.type="file",o.accept="image/*",o.style.position="fixed",o.style.left="0",o.style.top="0",o.style.opacity="0.001",document.body.appendChild(o);const s=l=>{var c;n||((c=o.parentNode)===null||c===void 0||c.removeChild(o),n=!0,e(l))},i=l=>{s(Array.prototype.slice.call(l.target.files))};o.addEventListener("input",i),o.addEventListener("change",i);const r=l=>{const c=()=>{s([])};n||(l.type==="focusin"?$.setEditorTimeout(t,c,1e3):c()),t.off("focusin remove",r)};t.on("focusin remove",r),o.click()}),_=t=>{t.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{F(t).then(e=>{if(e.length>0){const n=e[0];D(n).then(o=>{L(t,o,n)})}})}}),t.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{B(t,2,2)}})},p=(t=>()=>t)(!1);class a{constructor(e,n){this.tag=e,this.value=n}static some(e){return new a(!0,e)}static none(){return a.singletonNone}fold(e,n){return this.tag?n(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?a.some(e(this.value)):a.none()}bind(e){return this.tag?e(this.value):a.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:a.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(e){return S(e)?a.some(e):a.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}a.singletonNone=new a(!1),typeof window<"u"||Function("return this;")();const H=1,U=t=>t.dom.nodeName.toLowerCase(),O=(t,e)=>{const n=t.dom;return n&&n.hasAttribute?n.hasAttribute(e):!1};var v=(t,e,n,o,s)=>t(n,o)?a.some(n):f(s)&&s(n)?a.none():e(n,o,s);const j=(t,e)=>{const o=(e||document).createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||o.childNodes.length>1){const s="HTML does not have a single root node";throw console.error(s,t),new Error(s)}return u(o.childNodes[0])},z=(t,e)=>{const o=(e||document).createElement(t);return u(o)},G=(t,e)=>{const o=(e||document).createTextNode(t);return u(o)},u=t=>{if(t==null)throw new Error("Node cannot be null or undefined");return{dom:t}},d={fromHtml:j,fromTag:z,fromText:G,fromDom:u,fromPoint:(t,e,n)=>a.from(t.dom.elementFromPoint(e,n)).map(u)},y=(t,e)=>{const n=t.dom;if(n.nodeType!==H)return!1;{const o=n;if(o.matches!==void 0)return o.matches(e);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(e);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(e);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}},T=(t,e,n)=>{let o=t.dom;const s=f(n)?n:p;for(;o.parentNode;){o=o.parentNode;const i=d.fromDom(o);if(e(i))return a.some(i);if(s(i))break}return a.none()},R=(t,e,n)=>v((s,i)=>i(s),T,t,e,n),J=(t,e,n)=>R(t,e,n).isSome(),K=(t,e,n)=>T(t,o=>y(o,e),n),Q=(t,e,n)=>v((s,i)=>y(s,i),K,t,e,n),V=t=>{const e=x(t);e.length>0&&t.ui.registry.addContextToolbar("quickblock",{predicate:n=>{const o=d.fromDom(n),s=t.schema.getTextBlockElements(),i=r=>r.dom===t.getBody();return!O(o,"data-mce-bogus")&&Q(o,'table,[data-mce-bogus="all"]',i).fold(()=>J(o,r=>U(r)in s&&t.dom.isEmpty(r.dom),i),p)},items:e,position:"line",scope:"editor"})},W=t=>t.dom.classList!==void 0,X=(t,e)=>W(t)&&t.dom.classList.contains(e),Y=t=>{const e=r=>t.dom.isEditable(r),n=r=>e(r.parentElement),o=r=>{const l=r.nodeName==="FIGURE"&&/image/i.test(r.className),c=r.nodeName==="IMG"||l,ee=X(d.fromDom(r),"mce-pagebreak");return c&&n(r)&&!ee},s=P(t);s.length>0&&t.ui.registry.addContextToolbar("imageselection",{predicate:o,items:s,position:"node"});const i=C(t);i.length>0&&t.ui.registry.addContextToolbar("textselection",{predicate:r=>!o(r)&&!t.selection.isCollapsed()&&e(r),items:i,position:"selection",scope:"editor"})};var Z=()=>{k.add("quickbars",t=>{q(t),_(t),V(t),Y(t)})};Z()})();
//# sourceMappingURL=plugin-Dxmxwa97.cjs.map

"use strict";function Ns(J,pe){for(var Q=0;Q<pe.length;Q++){const E=pe[Q];if(typeof E!="string"&&!Array.isArray(E)){for(const N in E)if(N!=="default"&&!(N in J)){const Y=Object.getOwnPropertyDescriptor(E,N);Y&&Object.defineProperty(J,N,Y.get?Y:{enumerable:!0,get:()=>E[N]})}}}return Object.freeze(Object.defineProperty(J,Symbol.toStringTag,{value:"Module"}))}var ko={};(function(){var J=tinymce.util.Tools.resolve("tinymce.PluginManager");const pe=(e,t,o)=>{var n;return o(e,t.prototype)?!0:((n=e.constructor)===null||n===void 0?void 0:n.name)===t.name},Q=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&pe(e,String,(o,n)=>n.isPrototypeOf(o))?"string":t},E=e=>t=>Q(t)===e,N=e=>t=>typeof t===e,Y=e=>t=>e===t,$e=E("string"),Ne=E("array"),Fo=N("boolean"),_e=Y(void 0),Lo=e=>e==null,Ee=e=>!Lo(e),O=N("function"),Ho=N("number"),Wo=()=>{},jo=(e,t)=>o=>e(t(o)),h=e=>()=>e,Be=e=>e,qo=(e,t)=>e===t;function v(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const Vo=e=>{e()},Z=h(!1),ee=h(!0);class a{constructor(t,o){this.tag=t,this.value=o}static some(t){return new a(!0,t)}static none(){return a.singletonNone}fold(t,o){return this.tag?o(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?a.some(t(this.value)):a.none()}bind(t){return this.tag?t(this.value):a.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:a.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return Ee(t)?a.some(t):a.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}a.singletonNone=new a(!1);const q=Object.keys,St=Object.hasOwnProperty,te=(e,t)=>{const o=q(e);for(let n=0,l=o.length;n<l;n++){const r=o[n],s=e[r];t(s,r)}},Go=e=>(t,o)=>{e[o]=t},zo=(e,t,o,n)=>{te(e,(l,r)=>{(t(l,r)?o:n)(l,r)})},be=(e,t)=>{const o={};return zo(e,t,Go(o),Wo),o},Uo=(e,t)=>{const o=[];return te(e,(n,l)=>{o.push(t(n,l))}),o},wt=e=>Uo(e,Be),L=e=>q(e).length,B=(e,t)=>I(e,t)?a.from(e[t]):a.none(),I=(e,t)=>St.call(e,t),Ct=(e,t)=>I(e,t)&&e[t]!==void 0&&e[t]!==null,Ko=e=>{for(const t in e)if(St.call(e,t))return!1;return!0},Xo=Array.prototype.indexOf,Jo=Array.prototype.push,Qo=(e,t)=>Xo.call(e,t),A=(e,t)=>Qo(e,t)>-1,ke=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const l=e[o];if(t(l,o))return!0}return!1},vt=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},y=(e,t)=>{const o=e.length,n=new Array(o);for(let l=0;l<o;l++){const r=e[l];n[l]=t(r,l)}return n},T=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const l=e[o];t(l,o)}},Yo=(e,t)=>{for(let o=e.length-1;o>=0;o--){const n=e[o];t(n,o)}},Zo=(e,t)=>{const o=[],n=[];for(let l=0,r=e.length;l<r;l++){const s=e[l];(t(s,l)?o:n).push(s)}return{pass:o,fail:n}},V=(e,t)=>{const o=[];for(let n=0,l=e.length;n<l;n++){const r=e[n];t(r,n)&&o.push(r)}return o},en=(e,t,o)=>(Yo(e,(n,l)=>{o=t(o,n,l)}),o),Tt=(e,t,o)=>(T(e,(n,l)=>{o=t(o,n,l)}),o),tn=(e,t,o)=>{for(let n=0,l=e.length;n<l;n++){const r=e[n];if(t(r,n))return a.some(r);if(o(r,n))break}return a.none()},Fe=(e,t)=>tn(e,t,Z),on=e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!Ne(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);Jo.apply(t,e[o])}return t},oe=(e,t)=>on(y(e,t)),ge=(e,t)=>{for(let o=0,n=e.length;o<n;++o){const l=e[o];if(t(l,o)!==!0)return!1}return!0},nn=(e,t)=>{const o={};for(let n=0,l=e.length;n<l;n++){const r=e[n];o[String(r)]=t(r,n)}return o},xt=(e,t)=>t>=0&&t<e.length?a.some(e[t]):a.none(),ln=e=>xt(e,0),rn=e=>xt(e,e.length-1),Rt=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return a.none()},sn=8,At=9,Dt=11,Le=1,cn=3,an=(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const l="HTML does not have a single root node";throw console.error(l,e),new Error(l)}return ne(n.childNodes[0])},un=(e,t)=>{const n=(t||document).createElement(e);return ne(n)},mn=(e,t)=>{const n=(t||document).createTextNode(e);return ne(n)},ne=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},f={fromHtml:an,fromTag:un,fromText:mn,fromDom:ne,fromPoint:(e,t,o)=>a.from(e.dom.elementFromPoint(t,o)).map(ne)},k=(e,t)=>{const o=e.dom;if(o.nodeType!==Le)return!1;{const n=o;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},It=e=>e.nodeType!==Le&&e.nodeType!==At&&e.nodeType!==Dt||e.childElementCount===0,dn=(e,t)=>{const o=t===void 0?document:t.dom;return It(o)?[]:y(o.querySelectorAll(e),f.fromDom)},pn=(e,t)=>{const o=t===void 0?document:t.dom;return It(o)?a.none():a.from(o.querySelector(e)).map(f.fromDom)},M=(e,t)=>e.dom===t.dom,bn=k;typeof window<"u"||Function("return this;")();const D=e=>e.dom.nodeName.toLowerCase(),Ot=e=>e.dom.nodeType,fe=e=>t=>Ot(t)===e,gn=e=>Ot(e)===sn||D(e)==="#comment",G=fe(Le),He=fe(cn),fn=fe(At),hn=fe(Dt),We=e=>t=>G(t)&&D(t)===e,yn=e=>f.fromDom(e.dom.ownerDocument),Mt=e=>fn(e)?e:yn(e),he=e=>a.from(e.dom.parentNode).map(f.fromDom),Sn=(e,t)=>{const o=O(t)?t:Z;let n=e.dom;const l=[];for(;n.parentNode!==null&&n.parentNode!==void 0;){const r=n.parentNode,s=f.fromDom(r);if(l.push(s),o(s)===!0)break;n=r}return l},wn=e=>a.from(e.dom.previousSibling).map(f.fromDom),Pt=e=>a.from(e.dom.nextSibling).map(f.fromDom),le=e=>y(e.dom.childNodes,f.fromDom),Cn=(e,t)=>{const o=e.dom.childNodes;return a.from(o[t]).map(f.fromDom)},vn=e=>Cn(e,0),Tn=e=>hn(e)&&Ee(e.dom.host),xn=O(Element.prototype.attachShadow)&&O(Node.prototype.getRootNode)?e=>f.fromDom(e.dom.getRootNode()):Mt,Rn=e=>{const t=xn(e);return Tn(t)?a.some(t):a.none()},An=e=>f.fromDom(e.dom.host),je=e=>{const t=He(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const o=t.ownerDocument;return Rn(f.fromDom(t)).fold(()=>o.body.contains(t),jo(je,An))};var $t=(e,t,o,n,l)=>e(o,n)?a.some(o):O(l)&&l(o)?a.none():t(o,n,l);const qe=(e,t,o)=>{let n=e.dom;const l=O(o)?o:Z;for(;n.parentNode;){n=n.parentNode;const r=f.fromDom(n);if(t(r))return a.some(r);if(l(r))break}return a.none()},Dn=(e,t,o)=>$t((l,r)=>r(l),qe,e,t,o),In=(e,t)=>{const o=l=>t(f.fromDom(l));return Fe(e.dom.childNodes,o).map(f.fromDom)},z=(e,t,o)=>qe(e,n=>k(n,t),o),On=(e,t)=>In(e,o=>k(o,t)),Nt=(e,t)=>pn(t,e),ye=(e,t,o)=>$t((l,r)=>k(l,r),z,e,t,o),Mn=e=>ye(e,"[contenteditable]"),Pn=(e,t=!1)=>je(e)?e.dom.isContentEditable:Mn(e).fold(h(t),o=>$n(o)==="true"),$n=e=>e.dom.contentEditable,Nn=e=>e.nodeName.toLowerCase(),_n=e=>f.fromDom(e.getBody()),re=e=>t=>M(t,_n(e)),En=e=>e?e.replace(/px$/,""):"",P=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,Se=e=>f.fromDom(e.selection.getStart()),Bn=e=>f.fromDom(e.selection.getEnd()),kn=e=>Dn(e,We("table")).forall(Pn),Fn=(e,t)=>V(le(e),t),_t=(e,t)=>{let o=[];return T(le(e),n=>{t(n)&&(o=o.concat([n])),o=o.concat(_t(n,t))}),o},Ve=(e,t)=>Fn(e,o=>k(o,t)),Et=(e,t)=>dn(t,e),Bt=(e,t,o)=>{if($e(o)||Fo(o)||Ho(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple")},Ln=(e,t,o)=>{Bt(e.dom,t,o)},Hn=(e,t)=>{const o=e.dom;te(t,(n,l)=>{Bt(o,l,n)})},we=(e,t)=>{const o=e.dom.getAttribute(t);return o===null?void 0:o},se=(e,t)=>a.from(we(e,t)),kt=(e,t)=>{e.dom.removeAttribute(t)},Wn=e=>Tt(e.dom.attributes,(t,o)=>(t[o.name]=o.value,t),{}),Ft=(e,t,o=qo)=>e.exists(n=>o(n,t)),jn=e=>{const t=[],o=n=>{t.push(n)};for(let n=0;n<e.length;n++)e[n].each(o);return t},Lt=(e,t,o)=>e.isSome()&&t.isSome()?a.some(o(e.getOrDie(),t.getOrDie())):a.none(),qn=e=>e.bind(Be),Vn=(e,t)=>e?a.some(t):a.none(),Gn=(e,t)=>e.substring(t),zn=(e,t,o)=>t===""||e.length>=t.length&&e.substr(o,o+t.length)===t,Un=(e,t)=>Ht(e,t)?Gn(e,t.length):e,Ht=(e,t)=>zn(e,t,0),Kn=(e=>t=>t.replace(e,""))(/^\s+|\s+$/g),Wt=e=>e.length>0,Xn=e=>!Wt(e),jt=(e,t=10)=>{const o=parseInt(e,t);return isNaN(o)?a.none():a.some(o)},Jn=e=>{const t=parseFloat(e);return isNaN(t)?a.none():a.some(t)},Ge=e=>e.style!==void 0&&O(e.style.getPropertyValue),Qn=(e,t,o)=>{if(!$e(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);Ge(e)&&e.style.setProperty(t,o)},Yn=(e,t)=>{Ge(e)&&e.style.removeProperty(t)},Zn=(e,t,o)=>{const n=e.dom;Qn(n,t,o)},qt=(e,t)=>{const o=e.dom,l=window.getComputedStyle(o).getPropertyValue(t);return l===""&&!je(e)?Vt(o,t):l},Vt=(e,t)=>Ge(e)?e.style.getPropertyValue(t):"",U=(e,t)=>{const o=e.dom,n=Vt(o,t);return a.from(n).filter(l=>l.length>0)},el=(e,t)=>{const o=e.dom;Yn(o,t),Ft(se(e,"style").map(Kn),"")&&kt(e,"style")},ze=(e,t,o=0)=>se(e,t).map(n=>parseInt(n,10)).getOr(o),Gt=(e,t)=>zt(e,t,ee),zt=(e,t,o)=>oe(le(e),n=>k(n,t)?o(n)?[n]:[]:zt(n,t,o)),tl=["tfoot","thead","tbody","colgroup"],ol=e=>A(tl,e),nl=(e,t)=>({rows:e,columns:t}),Ut=(e,t,o)=>({element:e,rowspan:t,colspan:o}),ll=(e,t,o,n,l,r)=>({element:e,rowspan:t,colspan:o,row:n,column:l,isLocked:r}),Ue=(e,t,o)=>({element:e,cells:t,section:o}),rl=(e,t,o,n)=>({startRow:e,startCol:t,finishRow:o,finishCol:n}),sl=(e,t,o)=>({element:e,colspan:t,column:o}),cl=(e,t)=>({element:e,columns:t}),al=(e,t,o=Z)=>{if(o(t))return a.none();if(A(e,D(t)))return a.some(t);const n=l=>k(l,"table")||o(l);return z(t,e.join(","),n)},il=(e,t)=>al(["td","th"],e,t),ul=e=>Gt(e,"th,td"),ml=e=>k(e,"colgroup")?Ve(e,"col"):oe(Xt(e),t=>Ve(t,"col")),x=(e,t)=>ye(e,"table",t),Kt=e=>Gt(e,"tr"),Xt=e=>x(e).fold(h([]),t=>Ve(t,"colgroup")),dl=(e,t)=>y(e,o=>{if(D(o)==="colgroup"){const n=y(ml(o),l=>{const r=ze(l,"span",1);return Ut(l,1,r)});return Ue(o,n,"colgroup")}else{const n=y(ul(o),l=>{const r=ze(l,"rowspan",1),s=ze(l,"colspan",1);return Ut(l,r,s)});return Ue(o,n,t(o))}}),pl=e=>he(e).map(t=>{const o=D(t);return ol(o)?o:"tbody"}).getOr("tbody"),bl=e=>{const t=Kt(e),n=[...Xt(e),...t];return dl(n,pl)},gl="data-snooker-locked-cols",fl=e=>se(e,gl).bind(t=>a.from(t.match(/\d+/g))).map(t=>nn(t,ee)),Ke=(e,t)=>e+","+t,hl=(e,t,o)=>a.from(e.access[Ke(t,o)]),yl=(e,t,o)=>{const n=Jt(e,l=>o(t,l.element));return n.length>0?a.some(n[0]):a.none()},Jt=(e,t)=>{const o=oe(e.all,n=>n.cells);return V(o,t)},Sl=e=>{const t={};let o=0;return T(e.cells,n=>{const l=n.colspan;vt(l,r=>{const s=o+r;t[s]=sl(n.element,l,s)}),o+=l}),t},Qt=e=>{const t={},o=[],l=ln(e).map(C=>C.element).bind(x).bind(fl).getOr({});let r=0,s=0,c=0;const{pass:i,fail:u}=Zo(e,C=>C.section==="colgroup");T(u,C=>{const $=[];T(C.cells,F=>{let j=0;for(;t[Ke(c,j)]!==void 0;)j++;const ht=Ct(l,j.toString()),De=ll(F.element,F.rowspan,F.colspan,c,j,ht);for(let me=0;me<F.colspan;me++)for(let de=0;de<F.rowspan;de++){const yt=c+de,Ie=j+me,Oe=Ke(yt,Ie);t[Oe]=De,s=Math.max(s,Ie+1)}$.push(De)}),r++,o.push(Ue(C.element,$,C.section)),c++});const{columns:b,colgroups:d}=rn(i).map(C=>{const $=Sl(C);return{colgroups:[cl(C.element,wt($))],columns:$}}).getOrThunk(()=>({colgroups:[],columns:{}}));return{grid:nl(r,s),access:t,all:o,columns:b,colgroups:d}},_={fromTable:e=>{const t=bl(e);return Qt(t)},generate:Qt,getAt:hl,findItem:yl,filterItems:Jt,justCells:e=>oe(e.all,t=>t.cells),justColumns:e=>wt(e.columns),hasColumns:e=>q(e.columns).length>0,getColumnAt:(e,t)=>a.from(e.columns[t])};var Yt=tinymce.util.Tools.resolve("tinymce.util.Tools");const Ce=(e,t,o)=>{const n=e.select("td,th",t);let l;for(let r=0;r<n.length;r++){const s=e.getStyle(n[r],o);if(_e(l)&&(l=s),l!==s)return""}return l},Xe=(e,t,o)=>{Yt.each("left center right".split(" "),n=>{n!==o&&e.formatter.remove("align"+n,{},t)}),o&&e.formatter.apply("align"+o,{},t)},wl=(e,t,o)=>{Yt.each("top middle bottom".split(" "),n=>{n!==o&&e.formatter.remove("valign"+n,{},t)}),o&&e.formatter.apply("valign"+o,{},t)},Je=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},Cl=(e,t)=>Jn(e).getOr(t),ve=(e,t,o)=>Cl(qt(e,t),o),vl=(e,t,o,n)=>{const l=ve(e,`padding-${o}`,0),r=ve(e,`padding-${n}`,0),s=ve(e,`border-${o}-width`,0),c=ve(e,`border-${n}-width`,0);return t-l-r-s-c},Tl=(e,t)=>{const o=e.dom,n=o.getBoundingClientRect().width||o.offsetWidth;return vl(e,n,"left","right")},xl=e=>Tl(e);var Rl=tinymce.util.Tools.resolve("tinymce.Env");const Al="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",Dl=vt(5,e=>{const t=`${e+1}px`;return{title:t,value:t}}),Il=y(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],e=>({title:e,value:e.toLowerCase()})),Zt="100%",eo=e=>{var t;const o=e.dom,n=(t=o.getParent(e.selection.getStart(),o.isBlock))!==null&&t!==void 0?t:e.getBody();return xl(f.fromDom(n))+"px"},Ol=(e,t)=>so(e)||!H(e)?t:ro(e)?{...t,width:eo(e)}:{...t,width:Zt},Ml=(e,t)=>so(e)||H(e)?t:ro(e)?{...t,width:eo(e)}:{...t,width:Zt},w=e=>t=>t.options.get(e),Pl=e=>{const t=e.options.register;t("table_border_widths",{processor:"object[]",default:Dl}),t("table_border_styles",{processor:"object[]",default:Il}),t("table_cell_advtab",{processor:"boolean",default:!0}),t("table_row_advtab",{processor:"boolean",default:!0}),t("table_advtab",{processor:"boolean",default:!0}),t("table_appearance_options",{processor:"boolean",default:!0}),t("table_grid",{processor:"boolean",default:!Rl.deviceType.isTouch()}),t("table_cell_class_list",{processor:"object[]",default:[]}),t("table_row_class_list",{processor:"object[]",default:[]}),t("table_class_list",{processor:"object[]",default:[]}),t("table_toolbar",{processor:"string",default:Al}),t("table_background_color_map",{processor:"object[]",default:[]}),t("table_border_color_map",{processor:"object[]",default:[]})},to=w("table_sizing_mode"),oo=w("table_border_widths"),Qe=w("table_border_styles"),Ye=w("table_cell_advtab"),Ze=w("table_row_advtab"),K=w("table_advtab"),$l=w("table_appearance_options"),Nl=w("table_grid"),H=w("table_style_by_css"),et=w("table_cell_class_list"),_l=w("table_row_class_list"),tt=w("table_class_list"),El=w("table_toolbar"),no=w("table_background_color_map"),lo=w("table_border_color_map"),ro=e=>to(e)==="fixed",so=e=>to(e)==="responsive",co=e=>{const t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:Ol(e,o)},ao=e=>{const t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:Ml(e,o)},Bl=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,kl=(e,t)=>{let o=!0;const n=v(Bl,t);for(let l=t.startRow;l<=t.finishRow;l++)for(let r=t.startCol;r<=t.finishCol;r++)o=o&&_.getAt(e,l,r).exists(n);return o?a.some(t):a.none()},Fl=(e,t)=>rl(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),Ll=(e,t,o)=>{const n=_.findItem(e,t,M),l=_.findItem(e,o,M);return n.bind(r=>l.map(s=>Fl(r,s)))},Hl=(e,t,o)=>Ll(e,t,o).bind(n=>kl(e,n)),Wl=(e,t,o)=>{const n=jl(e);return Hl(n,t,o)},jl=_.fromTable,ot=(e,t)=>{he(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},io=(e,t)=>{Pt(e).fold(()=>{he(e).each(l=>{ce(l,t)})},n=>{ot(n,t)})},ql=(e,t)=>{vn(e).fold(()=>{ce(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},ce=(e,t)=>{e.dom.appendChild(t.dom)},Vl=(e,t)=>{ot(e,t),ce(t,e)},uo=(e,t)=>{T(t,(o,n)=>{const l=n===0?e:t[n-1];io(l,o)})},Gl=(e,t)=>{T(t,o=>{ce(e,o)})},mo=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},zl=e=>{const t=le(e);t.length>0&&uo(e,t),mo(e)},po=((e,t)=>{const o=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},n=r=>e(r)?a.from(r.dom.nodeValue):a.none();return{get:o,getOption:n,set:(r,s)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=s}}})(He,"text"),Ul=e=>po.get(e),Kl=(e,t)=>po.set(e,t);var Xl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Jl=()=>{const e=u=>f.fromDom(u.dom.cloneNode(!1)),t=u=>Mt(u).dom,o=u=>G(u)?D(u)==="body"?!0:A(Xl,D(u)):!1,n=u=>G(u)?A(["br","img","hr","input"],D(u)):!1,l=u=>G(u)&&we(u,"contenteditable")==="false",r=(u,b)=>u.dom.compareDocumentPosition(b.dom),s=(u,b)=>{const d=Wn(u);Hn(b,d)},c=u=>{const b=D(u);return A(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],b)},i=u=>G(u)?se(u,"lang"):a.none();return{up:h({selector:z,closest:ye,predicate:qe,all:Sn}),down:h({selector:Et,predicate:_t}),styles:h({get:qt,getRaw:U,set:Zn,remove:el}),attrs:h({get:we,set:Ln,remove:kt,copyTo:s}),insert:h({before:ot,after:io,afterAll:uo,append:ce,appendAll:Gl,prepend:ql,wrap:Vl}),remove:h({unwrap:zl,remove:mo}),create:h({nu:f.fromTag,clone:e,text:f.fromText}),query:h({comparePosition:r,prevSibling:wn,nextSibling:Pt}),property:h({children:le,name:D,parent:he,document:t,isText:He,isComment:gn,isElement:G,isSpecial:c,getLanguage:i,getText:Ul,setText:Kl,isBoundary:o,isEmptyTag:n,isNonEditable:l}),eq:M,is:bn}};const Ql=(e,t,o,n)=>{const l=o[0],r=o.slice(1);return n(e,t,l,r)},Yl=(e,t,o)=>o.length>0?Ql(e,t,o,Zl):a.none(),Zl=(e,t,o,n)=>{const l=t(e,o);return en(n,(r,s)=>{const c=t(e,s);return er(e,r,c)},l)},er=(e,t,o)=>t.bind(n=>o.filter(v(e.eq,n))),tr=Yl,or=Jl(),nr=(e,t)=>tr(or,(o,n)=>e(n),t),lr=e=>z(e,"table"),rr=(e,t)=>{const o=Et(e,t);return o.length>0?a.some(o):a.none()},sr=(e,t,o)=>Nt(e,t).bind(n=>Nt(e,o).bind(l=>nr(lr,[n,l]).map(r=>({first:n,last:l,table:r})))),cr=(e,t)=>rr(e,t),ar=(e,t,o)=>sr(e,t,o).bind(n=>{const l=i=>M(e,i),r="thead,tfoot,tbody,table",s=z(n.first,r,l),c=z(n.last,r,l);return s.bind(i=>c.bind(u=>M(i,u)?Wl(n.table,n.first,n.last):a.none()))}),nt=e=>y(e,f.fromDom),ir="data-mce-selected",bo="data-mce-first-selected",ur="td["+bo+"],th["+bo+"]",go="data-mce-last-selected",mr="td["+go+"],th["+go+"]",lt={selected:ir,firstSelectedSelector:ur,lastSelectedSelector:mr},dr=e=>x(e).bind(t=>cr(t,lt.firstSelectedSelector)).fold(h(e),t=>t[0]),fo=e=>(t,o)=>{const n=D(t),l=n==="col"||n==="colgroup"?dr(t):t;return ye(l,e,o)},ho=fo("th,td,caption"),yo=fo("th,td"),rt=e=>nt(e.model.table.getSelectedCells()),pr=(e,t)=>{const o=yo(e),n=o.bind(l=>x(l)).map(l=>Kt(l));return Lt(o,n,(l,r)=>V(r,s=>ke(nt(s.dom.cells),c=>we(c,t)==="1"||M(c,l)))).getOr([])},st=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],br=e=>({value:So(e)}),gr=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,fr=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,hr=e=>gr.test(e)||fr.test(e),So=e=>Un(e,"#").toUpperCase(),yr=e=>hr(e)?a.some({value:So(e)}):a.none(),ct=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},at=e=>{const t=ct(e.red)+ct(e.green)+ct(e.blue);return br(t)},Sr=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,wr=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,it=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),wo=(e,t,o,n)=>{const l=parseInt(e,10),r=parseInt(t,10),s=parseInt(o,10),c=parseFloat(n);return it(l,r,s,c)},Co=e=>{if(e==="transparent")return a.some(it(0,0,0,0));const t=Sr.exec(e);if(t!==null)return a.some(wo(t[1],t[2],t[3],"1"));const o=wr.exec(e);return o!==null?a.some(wo(o[1],o[2],o[3],o[4])):a.none()},Cr=e=>yr(e).orThunk(()=>Co(e).map(at)).getOrThunk(()=>{const t=document.createElement("canvas");t.height=1,t.width=1;const o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),o.fillStyle="#FFFFFF",o.fillStyle=e,o.fillRect(0,0,1,1);const n=o.getImageData(0,0,1,1).data,l=n[0],r=n[1],s=n[2],c=n[3];return at(it(l,r,s,c))}),vr=e=>Co(e).map(at).map(t=>"#"+t.value).getOr(e),ut=e=>{let t=e;return{get:()=>t,set:l=>{t=l}}},Tr=e=>{const t=ut(a.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(a.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:c=>{o(),t.set(a.some(c))}}},xr=()=>Tr(e=>e.unbind()),Rr=(e,t,o)=>n=>{const l=xr(),r=Xn(o),s=()=>{const c=rt(e),i=u=>e.formatter.match(t,{value:o},u.dom,r);r?(n.setActive(!ke(c,i)),l.set(e.formatter.formatChanged(t,u=>n.setActive(!u),!0))):(n.setActive(ge(c,i)),l.set(e.formatter.formatChanged(t,n.setActive,!1,{value:o})))};return e.initialized?s():e.on("init",s),l.clear},mt=e=>Ct(e,"menu"),ae=e=>y(e,t=>{const o=t.text||t.title||"";return mt(t)?{text:o,items:ae(t.menu)}:{text:o,value:t.value}}),W=(e,t,o,n)=>y(t,l=>{const r=l.text||l.title;return mt(l)?{type:"nestedmenuitem",text:r,getSubmenuItems:()=>W(e,l.menu,o,n)}:{text:r,type:"togglemenuitem",onAction:()=>n(l.value),onSetup:Rr(e,o,l.value)}}),X=(e,t)=>o=>{e.execCommand("mceTableApplyCellStyle",!1,{[t]:o})},ie=e=>oe(e,t=>mt(t)?[{...t,menu:ie(t.menu)}]:Wt(t.value)?[t]:[]),ue=(e,t,o,n)=>l=>l(W(e,t,o,n)),Te=(e,t,o)=>{const n=y(t,l=>({text:l.title,value:"#"+Cr(l.value).value,type:"choiceitem"}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:n.length>0?n:void 0,allowCustomColors:!1},onAction:l=>{const r=l.value==="remove"?"":l.value;e.execCommand("mceTableApplyCellStyle",!1,{[o]:r})}}]},vo=e=>()=>{const o=e.queryCommandValue("mceTableRowType")==="header"?"body":"header";e.execCommand("mceTableRowType",!1,{type:o})},To=e=>()=>{const o=e.queryCommandValue("mceTableColType")==="th"?"td":"th";e.execCommand("mceTableColType",!1,{type:o})},Ar=e=>{const t=ae(et(e));return t.length>0?a.some({name:"class",type:"listbox",label:"Class",items:t}):a.none()},Dr=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:st}],xo=e=>Dr.concat(Ar(e).toArray()),dt=(e,t)=>{const n=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(ae(Qe(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:t==="cell"?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},pt={normal:(e,t)=>{const o=e.dom;return{setAttrib:(s,c)=>{o.setAttrib(t,s,c)},setStyle:(s,c)=>{o.setStyle(t,s,c)},setFormat:(s,c)=>{c===""?e.formatter.remove(s,{value:null},t,!0):e.formatter.apply(s,{value:c},t)}}}},Ir=We("th"),Or=(e,t)=>e&&t?"sectionCells":e?"section":"cells",Mr=e=>{const t=e.section==="thead",o=Ft(Pr(e.cells),"th");return e.section==="tfoot"?{type:"footer"}:t||o?{type:"header",subType:Or(t,o)}:{type:"body"}},Pr=e=>{const t=V(e,o=>Ir(o.element));return t.length===0?a.some("td"):t.length===e.length?a.some("th"):a.none()},$r=e=>{const t=y(e,l=>Mr(l).type),o=A(t,"header"),n=A(t,"footer");if(!o&&!n)return a.some("body");{const l=A(t,"body");return o&&!l&&!n?a.some("header"):!o&&!l&&n?a.some("footer"):a.none()}},Nr=e=>{let t=!1,o;return(...n)=>(t||(t=!0,o=e.apply(null,n)),o)},Ro=(e,t)=>Rt(e.all,o=>Fe(o.cells,n=>M(t,n.element))),_r=(e,t,o)=>{const n=y(t.selection,r=>il(r).bind(s=>Ro(e,s)).filter(o)),l=jn(n);return Vn(l.length>0,l)},Er=(e,t)=>t.mergable,Br=(e,t)=>t.unmergable,Ao=(e,t)=>_r(e,t,ee),kr=(e,t)=>Ro(e,t).exists(o=>!o.isLocked),Do=(e,t)=>ge(t,o=>kr(e,o)),Fr=(e,t)=>Er(e,t).filter(o=>Do(e,o.cells)),Lr=(e,t)=>Br(e,t).filter(o=>Do(e,o));({...{generate:e=>{if(!Ne(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],o={};return T(e,(n,l)=>{const r=q(n);if(r.length!==1)throw new Error("one and only one name per case");const s=r[0],c=n[s];if(o[s]!==void 0)throw new Error("duplicate key detected:"+s);if(s==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Ne(c))throw new Error("case arguments must be an array");t.push(s),o[s]=(...i)=>{const u=i.length;if(u!==c.length)throw new Error("Wrong number of arguments to case "+s+". Expected "+c.length+" ("+c+"), got "+u);return{fold:(...d)=>{if(d.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+d.length);return d[l].apply(null,i)},match:d=>{const p=q(d);if(t.length!==p.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+p.join(","));if(!ge(t,$=>A(p,$)))throw new Error("Not all branches were specified when using match. Specified: "+p.join(", ")+`
Required: `+t.join(", "));return d[s].apply(null,i)},log:d=>{console.log(d,{constructors:t,constructor:s,params:i})}}}}),o}}.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])});const Hr=(e,t)=>{const o=_.fromTable(e);return Ao(o,t).bind(l=>{const r=l[l.length-1],s=l[0].row,c=r.row+r.rowspan,i=o.all.slice(s,c);return $r(i)}).getOr("")},xe=e=>Ht(e,"rgb")?vr(e):e,bt=e=>{const t=f.fromDom(e);return{borderwidth:U(t,"border-width").getOr(""),borderstyle:U(t,"border-style").getOr(""),bordercolor:U(t,"border-color").map(xe).getOr(""),backgroundcolor:U(t,"background-color").map(xe).getOr("")}},Io=e=>{const t=e[0],o=e.slice(1);return T(o,n=>{T(q(t),l=>{te(n,(r,s)=>{const c=t[l];c!==""&&l===s&&c!==r&&(t[l]="")})})}),t},Oo=(e,t,o,n)=>Fe(e,l=>!_e(o.formatter.matchNode(n,t+l))).getOr(""),gt=v(Oo,["left","center","right"],"align"),Wr=v(Oo,["top","middle","bottom"],"valign"),jr=(e,t)=>{const o=co(e),n=ao(e),l=()=>({borderstyle:B(o,"border-style").getOr(""),bordercolor:xe(B(o,"border-color").getOr("")),backgroundcolor:xe(B(o,"background-color").getOr(""))}),r={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},s=()=>{const b=o["border-width"];return H(e)&&b?{border:b}:B(n,"border").fold(()=>({}),d=>({border:d}))},c=t?l():{},i=()=>{const b=B(o,"border-spacing").or(B(n,"cellspacing")).fold(()=>({}),p=>({cellspacing:p})),d=B(o,"border-padding").or(B(n,"cellpadding")).fold(()=>({}),p=>({cellpadding:p}));return{...b,...d}};return{...r,...o,...n,...c,...s(),...i()}},qr=e=>x(f.fromDom(e)).map(t=>{const o={selection:nt(e.cells)};return Hr(t,o)}).getOr(""),Vr=(e,t,o)=>{const n=(c,i)=>{const u=U(f.fromDom(i),"border-width");return H(e)&&u.isSome()?u.getOr(""):c.getAttrib(i,"border")||Ce(e.dom,i,"border-width")||Ce(e.dom,i,"border")||""},l=e.dom,r=H(e)?l.getStyle(t,"border-spacing")||l.getAttrib(t,"cellspacing"):l.getAttrib(t,"cellspacing")||l.getStyle(t,"border-spacing"),s=H(e)?Ce(l,t,"padding")||l.getAttrib(t,"cellpadding"):l.getAttrib(t,"cellpadding")||Ce(l,t,"padding");return{width:l.getStyle(t,"width")||l.getAttrib(t,"width"),height:l.getStyle(t,"height")||l.getAttrib(t,"height"),cellspacing:r??"",cellpadding:s??"",border:n(l,t),caption:!!l.select("caption",t)[0],class:l.getAttrib(t,"class",""),align:gt(e,t),...o?bt(t):{}}},Gr=(e,t,o)=>{const n=e.dom;return{height:n.getStyle(t,"height")||n.getAttrib(t,"height"),class:n.getAttrib(t,"class",""),type:qr(t),align:gt(e,t),...o?bt(t):{}}},zr=(e,t,o,n)=>{const l=e.dom,r=n.getOr(t),s=(c,i)=>l.getStyle(c,i)||l.getAttrib(c,i);return{width:s(r,"width"),height:s(t,"height"),scope:l.getAttrib(t,"scope"),celltype:Nn(t),class:l.getAttrib(t,"class",""),halign:gt(e,t),valign:Wr(e,t),...o?bt(t):{}}},Mo=(e,t)=>{const o=_.fromTable(e),n=_.justCells(o),l=V(n,r=>ke(t,s=>M(r.element,s)));return y(l,r=>({element:r.element.dom,column:_.getColumnAt(o,r.column).map(s=>s.element.dom)}))},Ur=(e,t,o,n)=>{n("scope")&&e.setAttrib("scope",o.scope),n("class")&&e.setAttrib("class",o.class),n("height")&&e.setStyle("height",P(o.height)),n("width")&&t.setStyle("width",P(o.width))},Kr=(e,t,o)=>{o("backgroundcolor")&&e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),o("bordercolor")&&e.setFormat("tablecellbordercolor",t.bordercolor),o("borderstyle")&&e.setFormat("tablecellborderstyle",t.borderstyle),o("borderwidth")&&e.setFormat("tablecellborderwidth",P(t.borderwidth))},Xr=(e,t,o,n)=>{const l=t.length===1;T(t,r=>{const s=r.element,c=l?ee:n,i=pt.normal(e,s),u=r.column.map(b=>pt.normal(e,b)).getOr(i);Ur(i,u,o,c),Ye(e)&&Kr(i,o,c),n("halign")&&Xe(e,s,o.halign),n("valign")&&wl(e,s,o.valign)})},Jr=(e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},Qr=(e,t,o,n)=>{const l=be(n,(r,s)=>o[s]!==r);L(l)>0&&t.length>=1&&x(t[0]).each(r=>{const s=Mo(r,t),c=L(be(l,(u,b)=>b!=="scope"&&b!=="celltype"))>0,i=I(l,"celltype");(c||I(l,"scope"))&&Xr(e,s,n,v(I,l)),i&&Jr(e,n),Je(e,r.dom,{structure:i,style:c})})},Yr=(e,t,o,n)=>{const l=n.getData();n.close(),e.undoManager.transact(()=>{Qr(e,t,o,l),e.focus()})},Zr=(e,t)=>{const o=x(t[0]).map(n=>y(Mo(n,t),l=>zr(e,l.element,Ye(e),l.column)));return Io(o.getOrDie())},es=e=>{const t=rt(e);if(t.length===0)return;const o=Zr(e,t),n={type:"tabpanel",tabs:[{title:"General",name:"general",items:xo(e)},dt(e,"cell")]},l={type:"panel",items:[{type:"grid",columns:2,items:xo(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:Ye(e)?n:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:v(Yr,e,t,o)})},ts=e=>{const t=ae(_l(e));return t.length>0?a.some({name:"class",type:"listbox",label:"Class",items:t}):a.none()},os=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Po=e=>os.concat(ts(e).toArray()),ns=(e,t,o)=>{o("class")&&e.setAttrib("class",t.class),o("height")&&e.setStyle("height",P(t.height))},ls=(e,t,o)=>{o("backgroundcolor")&&e.setStyle("background-color",t.backgroundcolor),o("bordercolor")&&e.setStyle("border-color",t.bordercolor),o("borderstyle")&&e.setStyle("border-style",t.borderstyle)},rs=(e,t,o,n)=>{const r=t.length===1?ee:n;T(t,s=>{const c=pt.normal(e,s);ns(c,o,r),Ze(e)&&ls(c,o,r),n("align")&&Xe(e,s,o.align)})},ss=(e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},cs=(e,t,o,n)=>{const l=be(n,(r,s)=>o[s]!==r);if(L(l)>0){const r=I(l,"type"),s=r?L(l)>1:!0;s&&rs(e,t,n,v(I,l)),r&&ss(e,n),x(f.fromDom(t[0])).each(c=>Je(e,c.dom,{structure:r,style:s}))}},as=(e,t,o,n)=>{const l=n.getData();n.close(),e.undoManager.transact(()=>{cs(e,t,o,l),e.focus()})},is=e=>{const t=pr(Se(e),lt.selected);if(t.length===0)return;const o=y(t,s=>Gr(e,s.dom,Ze(e))),n=Io(o),l={type:"tabpanel",tabs:[{title:"General",name:"general",items:Po(e)},dt(e,"row")]},r={type:"panel",items:[{type:"grid",columns:2,items:Po(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:Ze(e)?l:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:v(as,e,y(t,s=>s.dom),n)})},us=(e,t,o)=>{const n=o?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],l=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],r=$l(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],s=[{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],c=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return n.concat(l).concat(r).concat(s).concat(c)},$o=(e,t,o,n)=>{if(t.tagName==="TD"||t.tagName==="TH")$e(o)&&Ee(n)?e.setStyle(t,o,n):e.setStyles(t,o);else if(t.children)for(let l=0;l<t.children.length;l++)$o(e,t.children[l],o,n)},ms=(e,t,o,n)=>{const l=e.dom,r={},s={},c=H(e),i=K(e);if(_e(o.class)||(r.class=o.class),s.height=P(o.height),c?s.width=P(o.width):l.getAttrib(t,"width")&&(r.width=En(o.width)),c?(s["border-width"]=P(o.border),s["border-spacing"]=P(o.cellspacing)):(r.border=o.border,r.cellpadding=o.cellpadding,r.cellspacing=o.cellspacing),c&&t.children){const u={};if(n.border&&(u["border-width"]=P(o.border)),n.cellpadding&&(u.padding=P(o.cellpadding)),i&&n.bordercolor&&(u["border-color"]=o.bordercolor),!Ko(u))for(let b=0;b<t.children.length;b++)$o(l,t.children[b],u)}if(i){const u=o;s["background-color"]=u.backgroundcolor,s["border-color"]=u.bordercolor,s["border-style"]=u.borderstyle}l.setStyles(t,{...co(e),...s}),l.setAttribs(t,{...ao(e),...r})},ds=(e,t,o,n)=>{const l=e.dom,r=n.getData(),s=be(r,(c,i)=>o[i]!==c);n.close(),r.class===""&&delete r.class,e.undoManager.transact(()=>{if(!t){const c=jt(r.cols).getOr(1),i=jt(r.rows).getOr(1);e.execCommand("mceInsertTable",!1,{rows:i,columns:c}),t=yo(Se(e),re(e)).bind(u=>x(u,re(e))).map(u=>u.dom).getOrDie()}if(L(s)>0){const c={border:I(s,"border"),bordercolor:I(s,"bordercolor"),cellpadding:I(s,"cellpadding")};ms(e,t,r,c);const i=l.select("caption",t)[0];(i&&!r.caption||!i&&r.caption)&&e.execCommand("mceTableToggleCaption"),Xe(e,t,r.align)}if(e.focus(),e.addVisual(),L(s)>0){const c=I(s,"caption"),i=c?L(s)>1:!0;Je(e,t,{structure:c,style:i})}})},No=(e,t)=>{const o=e.dom;let n,l=jr(e,K(e));t?(l.cols="1",l.rows="1",K(e)&&(l.borderstyle="",l.bordercolor="",l.backgroundcolor="")):(n=o.getParent(e.selection.getStart(),"table",e.getBody()),n?l=Vr(e,n,K(e)):K(e)&&(l.borderstyle="",l.bordercolor="",l.backgroundcolor=""));const r=ae(tt(e));r.length>0&&l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,""));const s={type:"grid",columns:2,items:us(e,r,t)},c=()=>({type:"panel",items:[s]}),i=()=>({type:"tabpanel",tabs:[{title:"General",name:"general",items:[s]},dt(e,"table")]}),u=K(e)?i():c();e.windowManager.open({title:"Table Properties",size:"normal",body:u,onSubmit:v(ds,e,n,l),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:l})},ps=e=>{const t=o=>{kn(Se(e))&&o()};te({mceTableProps:v(No,e,!1),mceTableRowProps:v(is,e),mceTableCellProps:v(es,e),mceInsertTableDialog:v(No,e,!0)},(o,n)=>e.addCommand(n,()=>t(o)))},bs=(e,t)=>On(e,t).isSome(),gs=Be,fs=e=>{const t=(n,l)=>se(n,l).exists(r=>parseInt(r,10)>1),o=n=>t(n,"rowspan")||t(n,"colspan");return e.length>0&&ge(e,o)?a.some(e):a.none()},hs=(e,t,o)=>t.length<=1?a.none():ar(e,o.firstSelectedSelector,o.lastSelectedSelector).map(n=>({bounds:n,cells:t})),ys=e=>({element:e,mergable:a.none(),unmergable:a.none(),selection:[e]}),Ss=(e,t,o)=>({element:o,mergable:hs(t,e,lt),unmergable:fs(e),selection:gs(e)}),ws=e=>{const t=ut(a.none()),o=ut([]);let n=a.none();const l=We("caption"),r=m=>n.forall(g=>!g[m]),s=()=>ho(Se(e),re(e)),c=()=>ho(Bn(e),re(e)),i=()=>s().bind(m=>qn(Lt(x(m),c().bind(x),(g,S)=>M(g,S)?l(m)?a.some(ys(m)):a.some(Ss(rt(e),g,m)):a.none()))),u=m=>x(m.element).map(S=>{const R=_.fromTable(S),Ps=Ao(R,m).getOr([]),$s=Tt(Ps,(Me,Pe)=>(Pe.isLocked&&(Me.onAny=!0,Pe.column===0?Me.onFirst=!0:Pe.column+Pe.colspan>=R.grid.columns&&(Me.onLast=!0)),Me),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Fr(R,m).isSome(),unmergeable:Lr(R,m).isSome(),locked:$s}}),b=()=>{t.set(Nr(i)()),n=t.get().bind(u),T(o.get(),Vo)},d=m=>(m(),o.set(o.get().concat([m])),()=>{o.set(V(o.get(),g=>g!==m))}),p=(m,g)=>d(()=>t.get().fold(()=>{m.setEnabled(!1)},S=>{m.setEnabled(!g(S)&&e.selection.isEditable())})),C=(m,g,S)=>d(()=>t.get().fold(()=>{m.setEnabled(!1),m.setActive(!1)},R=>{m.setEnabled(!g(R)&&e.selection.isEditable()),m.setActive(S(R))})),$=m=>n.exists(g=>g.locked[m]),F=m=>p(m,g=>!1),j=m=>p(m,g=>l(g.element)),ht=m=>g=>p(g,S=>l(S.element)||$(m)),De=m=>g=>p(g,S=>l(S.element)||m().isNone()),me=(m,g)=>S=>p(S,R=>l(R.element)||m().isNone()||$(g)),de=m=>p(m,g=>r("mergeable")),yt=m=>p(m,g=>r("unmergeable")),Ie=m=>C(m,Z,g=>x(g.element,re(e)).exists(R=>bs(R,"caption"))),Oe=(m,g)=>S=>C(S,R=>l(R.element),()=>e.queryCommandValue(m)===g),Os=Oe("mceTableRowType","header"),Ms=Oe("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",b),{onSetupTable:F,onSetupCellOrRow:j,onSetupColumn:ht,onSetupPasteable:De,onSetupPasteableColumn:me,onSetupMergeable:de,onSetupUnmergeable:yt,resetTargets:b,onSetupTableWithCaption:Ie,onSetupTableRowHeaders:Os,onSetupTableColumnHeaders:Ms,targets:t.get}};var Cs=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const _o="x-tinymce/dom-table-",vs=_o+"rows",Ts=_o+"columns",Eo=e=>{var t;const o=(t=Cs.read())!==null&&t!==void 0?t:[];return Rt(o,n=>a.from(n.getType(e)))},Re=()=>Eo(vs),Ae=()=>Eo(Ts),Bo=e=>t=>{const o=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",o),o(),()=>{e.off("NodeChange",o)}},xs=(e,t)=>{e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",onSetup:Bo(e),fetch:c=>c("inserttable | cell row column | advtablesort | tableprops deletetable")});const o=c=>()=>e.execCommand(c),n=(c,i)=>{e.queryCommandSupported(i.command)&&e.ui.registry.addButton(c,{...i,onAction:O(i.onAction)?i.onAction:o(i.command)})},l=(c,i)=>{e.queryCommandSupported(i.command)&&e.ui.registry.addToggleButton(c,{...i,onAction:O(i.onAction)?i.onAction:o(i.command)})};n("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:t.onSetupTable}),n("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:t.onSetupTable}),n("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),n("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),n("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),n("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:t.onSetupCellOrRow}),n("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:t.onSetupCellOrRow}),n("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:t.onSetupPasteable(Re)}),n("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:t.onSetupPasteable(Re)}),n("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:t.onSetupColumn("onAny")}),n("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:t.onSetupColumn("onAny")}),n("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:t.onSetupPasteableColumn(Ae,"onFirst")}),n("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:t.onSetupPasteableColumn(Ae,"onLast")}),n("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table",onSetup:Bo(e)});const r=ie(tt(e));r.length!==0&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:ue(e,r,"tableclass",c=>e.execCommand("mceTableToggleClass",!1,c)),onSetup:t.onSetupTable});const s=ie(et(e));s.length!==0&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:ue(e,s,"tablecellclass",c=>e.execCommand("mceTableCellToggleClass",!1,c)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:ue(e,st,"tablecellverticalalign",X(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:ue(e,oo(e),"tablecellborderwidth",X(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:ue(e,Qe(e),"tablecellborderstyle",X(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:c=>c(Te(e,no(e),"background-color")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:c=>c(Te(e,lo(e),"border-color")),onSetup:t.onSetupCellOrRow})),l("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),l("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:vo(e),onSetup:t.onSetupTableRowHeaders}),l("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:To(e),onSetup:t.onSetupTableColumnHeaders})},Rs=e=>{const t=n=>e.dom.is(n,"table")&&e.getBody().contains(n)&&e.dom.isEditable(n.parentNode),o=El(e);o.length>0&&e.ui.registry.addContextToolbar("table",{predicate:t,items:o,scope:"node",position:"node"})},ft=e=>t=>{const o=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",o),o(),()=>{e.off("NodeChange",o)}},As=(e,t)=>{const o=d=>()=>e.execCommand(d),n=(d,p)=>e.queryCommandSupported(p.command)?(e.ui.registry.addMenuItem(d,{...p,onAction:O(p.onAction)?p.onAction:o(p.command)}),!0):!1,l=(d,p)=>{e.queryCommandSupported(p.command)&&e.ui.registry.addToggleMenuItem(d,{...p,onAction:O(p.onAction)?p.onAction:o(p.command)})},r=d=>{e.execCommand("mceInsertTable",!1,{rows:d.numRows,columns:d.numColumns})},s=[n("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:t.onSetupCellOrRow}),n("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:t.onSetupCellOrRow}),n("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:t.onSetupCellOrRow}),n("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:t.onSetupCellOrRow}),n("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:t.onSetupCellOrRow}),n("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:t.onSetupCellOrRow}),n("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:t.onSetupPasteable(Re)}),n("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:t.onSetupPasteable(Re)})],c=[n("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:t.onSetupColumn("onFirst")}),n("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:t.onSetupColumn("onLast")}),n("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:t.onSetupColumn("onAny")}),n("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:t.onSetupColumn("onAny")}),n("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:t.onSetupColumn("onAny")}),n("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:t.onSetupPasteableColumn(Ae,"onFirst")}),n("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:t.onSetupPasteableColumn(Ae,"onLast")})],i=[n("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:t.onSetupCellOrRow}),n("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:t.onSetupMergeable}),n("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:t.onSetupUnmergeable})];Nl(e)?e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}],onSetup:ft(e)}):e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTableDialog"),onSetup:ft(e)}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTableDialog"),onSetup:ft(e)}),n("tableprops",{text:"Table properties",onSetup:t.onSetupTable,command:"mceTableProps"}),n("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,command:"mceTableDelete"}),A(s,!0)&&e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:h("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),A(c,!0)&&e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:h("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),A(i,!0)&&e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:h("tablecellprops tablemergecells tablesplitcells")}),e.ui.registry.addContextMenu("table",{update:()=>(t.resetTargets(),t.targets().fold(h(""),d=>D(d.element)==="caption"?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"))});const u=ie(tt(e));u.length!==0&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>W(e,u,"tableclass",d=>e.execCommand("mceTableToggleClass",!1,d)),onSetup:t.onSetupTable});const b=ie(et(e));b.length!==0&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>W(e,b,"tablecellclass",d=>e.execCommand("mceTableCellToggleClass",!1,d)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>W(e,st,"tablecellverticalalign",X(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>W(e,oo(e),"tablecellborderwidth",X(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>W(e,Qe(e),"tablecellborderstyle",X(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>Te(e,no(e),"background-color"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>Te(e,lo(e),"border-color"),onSetup:t.onSetupCellOrRow})),l("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),l("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:vo(e),onSetup:t.onSetupTableRowHeaders}),l("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:To(e),onSetup:t.onSetupTableRowHeaders})},Ds=e=>{const t=ws(e);Pl(e),ps(e),As(e,t),xs(e,t),Rs(e)};var Is=()=>{J.add("table",Ds)};Is()})();const _s=Ns({__proto__:null,default:ko},[ko]);exports.index=_s;
//# sourceMappingURL=index-DISOMVl3.cjs.map

"use strict";function $(s,i){for(var c=0;c<i.length;c++){const a=i[c];if(typeof a!="string"&&!Array.isArray(a)){for(const r in a)if(r!=="default"&&!(r in s)){const l=Object.getOwnPropertyDescriptor(a,r);l&&Object.defineProperty(s,r,l.get?l:{enumerable:!0,get:()=>a[r]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}var b={};(function(){var s=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),c=tinymce.util.Tools.resolve("tinymce.util.Tools");const a=e=>t=>t.options.get(e),r=e=>{const t=e.options.register;t("allow_html_in_named_anchor",{processor:"boolean",default:!1})},l=a("allow_html_in_named_anchor"),m="a:not([href])",u=e=>!e,d=e=>e.getAttribute("id")||e.getAttribute("name")||"",A=e=>e.nodeName.toLowerCase()==="a",h=e=>A(e)&&!e.getAttribute("href")&&d(e)!=="",y=e=>h(e)&&!e.firstChild,v=e=>{const t=e.dom;i(t).walk(e.selection.getRng(),n=>{c.each(n,o=>{y(o)&&t.remove(o,!1)})})},N=e=>/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(e),g=e=>e.dom.getParent(e.selection.getStart(),m),_=e=>{const t=g(e);return t?d(t):""},C=(e,t)=>{e.undoManager.transact(()=>{l(e)||e.selection.collapse(!0),e.selection.isCollapsed()?e.insertContent(e.dom.createHTML("a",{id:t})):(v(e),e.formatter.remove("namedAnchor",void 0,void 0,!0),e.formatter.apply("namedAnchor",{value:t}),e.addVisual())})},S=(e,t,n)=>{n.removeAttribute("name"),n.id=t,e.addVisual(),e.undoManager.add()},w=(e,t)=>{const n=g(e);n?S(e,t,n):C(e,t),e.focus()},I=(e,t)=>N(t)?(w(e,t),!0):(e.windowManager.alert("ID should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."),!1),E=e=>{const t=_(e);e.windowManager.open({title:"Anchor",size:"normal",body:{type:"panel",items:[{name:"id",type:"input",label:"ID",placeholder:"example"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{id:t},onSubmit:n=>{I(e,n.getData().id)&&n.close()}})},M=e=>{e.addCommand("mceAnchor",()=>{E(e)})},P=e=>u(e.attr("href"))&&!u(e.attr("id")||e.attr("name")),x=e=>P(e)&&!e.firstChild,f=e=>t=>{for(let n=0;n<t.length;n++){const o=t[n];x(o)&&o.attr("contenteditable",e)}},T=e=>{e.on("PreInit",()=>{e.parser.addNodeFilter("a",f("false")),e.serializer.addNodeFilter("a",f(null))})},k=e=>{e.formatter.register("namedAnchor",{inline:"a",selector:m,remove:"all",split:!0,deep:!0,attributes:{id:"%value"},onmatch:(t,n,o)=>h(t)})},p=e=>t=>{const n=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",n),n(),()=>{e.off("NodeChange",n)}},O=e=>{const t=()=>e.execCommand("mceAnchor");e.ui.registry.addToggleButton("anchor",{icon:"bookmark",tooltip:"Anchor",onAction:t,onSetup:n=>{const o=e.selection.selectorChangedWithUnbind("a:not([href])",n.setActive).unbind,D=p(e)(n);return()=>{o(),D()}}}),e.ui.registry.addMenuItem("anchor",{icon:"bookmark",text:"Anchor...",onAction:t,onSetup:p(e)})};var z=()=>{s.add("anchor",e=>{r(e),T(e),M(e),O(e),e.on("PreInit",()=>{k(e)})})};z()})();const j=$({__proto__:null,default:b},[b]);exports.index=j;
//# sourceMappingURL=index-DMKezR2K.cjs.map
